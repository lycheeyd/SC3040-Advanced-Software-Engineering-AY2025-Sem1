# SC3040-Advanced-Software-Engineering

## Prerequisites
- Java 21
- Maven 3.6+
- Flutter SDK 3.0+
- HuggingFace Space (HF) [Docker Build]
- Git

## Architecture
- **Backend**: 5 Spring Boot microservices + 1 Spring Boot API Gateway (Hosted on HuggingFace)
- **Frontend**: Flutter Based Mobile & Web application
- **Database**: Microsoft SQL Server 2022 (Hosted on NTU's Virtual Machine behind a VPN)

## Backend Setup

### 1. HuggingFace Requirements
**IMPORTANT**: 
- All backend services are configured to use port 7860 as mandated by HuggingFace
- All service must await and respond to "/" Get request from HuggingFace to complete container startup
- HuggingFace adopts Readme.md file as configuration file for Space's metadata

### 2. HuggingFace Secrets
- Github fine grained PAT:  Read access to actions, code, and metadata

### 3. HuggingFace Variables (Dynamically injected)
- Github Repository
- Service Name
- Build_ID

### 3. HuggingFace Configuration Files
- Dockerfile (Same across all services)
- Readme.md (Unique per service)
- Build-Vars.env (Hold variables in #3, dynamically generated by CI/CD pipeline)

### 4. MicroService Naming Convention
This naming convention must be adhered for naming Service Folders in GitHub and creating Spaces on HuggingFace
- **HF Staging Environments (UAT Branch):** Calowin{SERVICENAME}
- **HF Production Environments (Main Branch):** Calowin{SERVICENAME}Live
- **GitHub Folders:** {SERVICENAME} (Placed in Root Directory)

- Horizontal Scale Out (Future): {EnvironmentName}-N (where N is integer with increment of 1) [E.g. CalowinAccount-1]

### 5. HuggingFace Space Setup
Create a HF space following the specified **naming convention** with the following options:
- Docker SDK
- Blank template
- Public

### 6. Extra notes
- Email generation uses Google OAuth + Gmail API instead of Gmail SMTP, while both are available due to SMTP port restriction by HuggingFace.
- A Bastlion Server is setup to bypass VPN wall for establishing connection to the Virtual Machine hosting the database

## GitHub Deployment Setup

### 1. GitHub Secrets
- Github fine grained PAT:
  - Read access to metadata
  - Read and Write access to actions variables and code
    
- HuggingFace Access Token
- HuggingFace Username

### 2. GitHub Environments
- UAT
- Production

### 3. GitHub Variables (Automated by CI/CD)
#### 1. UAT Environment
 - List of successful Build_ID(s) for version based deployment on HuggingFace and tracking
 - **Variable Name Generation Convention**:
   - BUILD_ID_{SERVICENAME}_{short_commit_SHA}

#### 2. Production Environment
 - Tracks the current version (Build_ID) deployed on HF production environments
 - **Variable Name Generation Convention**:
   - LAST_BUILD_ID_{SERVICENAME}

### 4. CI/CD Pipeline Workflows
- **Automatic Deployment:** deploy-services-v3.yml
  - Triggered On pull-request completion into UAT branch and main branch
    
- **Manual Deployment:** manual-full-deploy-services.yml
  - Options available to deploy each services individually OR All

- **Erase the Artifact Library:** purge.yml

<img width="1026" height="428" alt="image" src="https://github.com/user-attachments/assets/1b513921-dfae-429c-8f23-d2ac215bc253" />

## Frontend Setup
- Emulator (Android / IOS)
- Direct installation

## Repository Layout
- **CalowinAcount:**       Account Microservice
- **CalowinFriends:**      Friends Microservice
- **CalowinNotification:** Notification Microservice
- **CalowinSpringNode:**   API Gateway Microservice
- **CalowinTrip:**         Trip Microservice
- **CalowinWellnessZone:** WellnessZone Microservice
- **calowin_ui:**          Flutter Frontend Application
- **HF_setup_obsolete:**   Obsoleted initial non-CI/CD deployment setup structure (Record Keeping Purpose)
- **atomikos-logs:**       Backend Microservice logging destination for local development

## Calowin Application DEMO Video
